{% for q in rows %}
<article class="question-card" x-data="{ showExplanation: false }">
    <!-- Header -->
    <header class="question-card-header">
        <span class="question-id">#{{ q.id }}</span>
        <span class="badge">{{ q.content_area }}</span>
        <span class="difficulty-stars">
            {% if q.difficulty %}
                {% for i in range(q.difficulty) %}★{% endfor %}{% for i in range(5 - q.difficulty) %}☆{% endfor %}
            {% else %}
                —
            {% endif %}
        </span>
        {% if q.model %}
        <span class="text-xs text-text-muted font-mono" title="Generated by {{ q.model }}">{{ q.model | replace('claude-', '') | replace('-20250514', '') }}</span>
        {% endif %}
        <span class="question-date">{{ q.created_at[:10] if q.created_at else '' }}</span>
    </header>

    <!-- Body -->
    <div class="question-card-body">
        <div class="question-text">
            <p>{{ q.content }}</p>
        </div>

        <div class="options-grid">
            {% for key, value in q.options.items() %}
            <div class="option" :class="{ 'correct': showExplanation && '{{ key }}' === '{{ q.correct_answer }}' }">
                <span class="option-key">{{ key }})</span>
                <span class="option-text">{{ value }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Footer -->
    <footer class="question-card-footer">
        <button class="btn-secondary-sm" @click="showExplanation = !showExplanation" x-text="showExplanation ? 'Hide Explanation' : 'Show Explanation'"></button>
        <a href="/tables/questions/{{ q.id }}" class="btn-ghost-sm">View Details</a>
    </footer>

    <!-- Explanation (Collapsible) -->
    <div class="question-explanation" x-show="showExplanation" x-collapse>
        <blockquote>
            <strong class="text-text-primary">Correct: {{ q.correct_answer }}</strong><br>
            {{ q.explanation }}
        </blockquote>
    </div>
</article>
{% else %}
<article class="card p-8 text-center">
    <p class="text-text-muted">No questions found matching your filters.</p>
</article>
{% endfor %}

{% if total > 0 %}
<nav aria-label="Pagination" class="pagination">
    {% if page > 1 %}
    <a href="?page={{ page - 1 }}&search={{ search }}&content_area={{ content_area }}&difficulty={{ difficulty }}"
       hx-get="/questions/cards?page={{ page - 1 }}&search={{ search }}&content_area={{ content_area }}&difficulty={{ difficulty }}"
       hx-target="#questions-content"
       class="btn-ghost-sm">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Previous
    </a>
    {% else %}
    <span class="btn-ghost-sm opacity-50 cursor-not-allowed">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Previous
    </span>
    {% endif %}

    <span class="pagination-info text-sm">
        Showing {{ ((page - 1) * per_page) + 1 }}-{{ [page * per_page, total] | min }} of {{ total }}
    </span>

    {% if page < pages %}
    <a href="?page={{ page + 1 }}&search={{ search }}&content_area={{ content_area }}&difficulty={{ difficulty }}"
       hx-get="/questions/cards?page={{ page + 1 }}&search={{ search }}&content_area={{ content_area }}&difficulty={{ difficulty }}"
       hx-target="#questions-content"
       class="btn-ghost-sm">
        Next
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
    </a>
    {% else %}
    <span class="btn-ghost-sm opacity-50 cursor-not-allowed">
        Next
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
    </span>
    {% endif %}
</nav>
{% endif %}
